# k-trader

BitThumb 거래소용 Bitcoin 자동 매매 Android app 프로그램입니다.  
UI는 허접하고 버그도 있지만 그냥저냥 돈 버는데 문제는 없어서 정 급할 때만 하나씩 고쳐가며 쓰고 있습니다.  
가까운 분들께 공개를 했으니 이제는 편의성도 조금씩 신경써 보려고 합니다.  
  
기본적으로 비트코인의 변동성을 수익화 하는 거래전략을 사용합니다.  
변동성이 0이면 수익도 0이고, 변동성이 커지면 거래가 많이 발생하고 따라서 수익도 커지는 구조입니다.  
원래 주식에서 사용하던 전략을 개량해서 2017년부터 운영하고 있는데 수익률이 나쁘지 않습니다. 평균 월 2% 정도.  
  
투자금이 적으면 수익도 적고 투자금이 크면 수익도 커집니다.  
코드는 그대로인데 말이죠  
계속 느끼는 점이지만 결국 돈 놓고 돈 먹기 입니다.  
돈이 많아야 더 많이 벌 수 있습니다.  
  
처음에는 치킨값 정도 벌었는데 지금은 투자금을 늘려서 생활비를 상당 부분 대체하고 있습니다.  
투자금을 더 늘려서 수익이 연봉 정도 나오면 은퇴도 가능하겠지요?  
비트코인이 없어질거라고는 생각하지 않지만 혹시나 없어지게 되면 비슷한 변동성을 가진 다른 자산으로 옮겨가서 같은 로직을 적용할 수 있을거라 봅니다.  
  
돈 버는거 혼자 알지 왜 공개하느냐, 이거 공개해서 제가 얻을 이득은 없습니다.  
백도어도 없고 저한테 투자금 맡기는 것도 아니고 맡을 생각도 없습니다.  
제꺼 벌기 바빠요 ㅎㅎ  
그냥 이걸로 돈 벌면 밥이나 한 번 사주세요.  
#

* UI 구성
1. 메인 화면
   - 거래 시작/종료 버튼, 세팅 화면 버튼으로 구성
   - <img src="/doc/main_screen.jpg" width="150" height="300"/>
2. 거래 대기 목록 화면
   - 리스트 최상위에는 매수 대기 item 1개와 그 하위에는 매도 대기 item의 list로 구성
   - <img src="/doc/order_screen.jpg" width="150" height="300"/>
3. 거래 완료 목록 화면
   - 기간별 누적 거래량과 수수료 총합을 볼 수 있게 구성
   - <img src="/doc/history_screen.jpg" width="150" height="300"/>
4. 세팅 화면
   - API secret, key, unit price를 설정할 수 있도록 구성
   - <img src="/doc/setting_screen.jpg" width="150" height="300"/>
#

* 사용법
1. 빗썸 사이트에서 API_KEY와 API_SECRET 값을 생성 (보안을 위해 입출금 권한은 빼는 것 추천)
2. 빗썸 사이트에서 투자금 입금 (100만원 이상 추천)
3. App실행 후 세팅 화면으로 가서 API_KEY와 API_SECRET, 거래 단위 금액 값을 입력
   - 거래 단위 금액은 '1만원~118만원' 검증 완료, 그 이하/이상 금액은 검증 필요
4. 세팅 화면 이외 화면들간 전환은 좌우 Flick을 사용하며 화면 전환을 위한 별도 UI는 없음
5. 메인화면에서 거래 시작 버튼을 누르면 1분 마다 자동 거래 동작
6. App이 종료 되지 않도록 주기적으로 모니터링 해주면 됨
   - 메인 화면의 로그 창에서 오류(null)가 없는지도 모니터링 필요
7. 수익 처리
   - 메인화면 로그 중 '예상잔고' 기준으로 수익금을 판단하고 처리
   - 예) 예상잔고가 투자금+50만원이 되면 빗썸앱으로 가서 50만원을 수익금으로 출금
8. 손실 처리
   - 빗썸의 매도 리스트는 1년 2년이 지나도 없어지지 않고 잘 유지됨
   - 손실은 확정하지 않는 한 손실이 아님. 다 매도하고 싶을 때가 최저가임
   - 급히 필요한 돈이 아닌한 손실을 확정할 이유는 없음
   - 3년 이상 안 써도 되는 여유 자금으로만 투자하길 추천
#

* Known issues
1. Back key로는 app이 종료되지 않으나 Task manager에서 종료할 경우 실제 종료되어 이후 거래가 되지 않으므로 실수로 종료하지 않도록 주의 필요
   - Background process로 구현 필요 (미구현)
2. Android 소모 전류 정책에 따라 1분 스케줄링이 pause 될 수 있음
   - 1분 스케줄링을 내부 타이머가 아닌 FireBase message로 변경 필요 (미구현)
   - 충전 중일 때는 정상 동작하므로 자기 전에는 충전 추천
3. 1분 이내 0.5% 이상의 급락이 발생한 경우 매수 구간이 skip 될 수 있음
   - 예를 들어 3% 급락시 이론상 0.5%씩 6개의 매수가 발생해야 하지만 한 턴에 하나의 매수만 발생시키므로 6개가 아닌 1개 매수만 발생
4. 가끔 빗썸 서버에서 잔고를 읽어오지 못하는 문제 발생(두어달에 한번 정도?)
   - 안드로이드 네트웍 쪽 문제로 보이는데 원인 불명, App 재실행으로는 해결되지 않고 '모바일 데이터'를 껐다 켜기 또는 폰 리부팅을 해야 해결됨
#

* 기본 전략
1. 투자금을 100등분 한 금액(Unit price)을 매수/매도 단위로 함 (예: 투자금 1억인 경우 매수/매도 단위는 100만원)
2. Bitcoin 현재가에서 1,000만원 단위 미만을 절사한 금액의 (예: 현재가 4,532만원 -> 4,000만원) 0.5% 변동(예: 4,000*0.5%=20만원)시 거래가 발생하도록 함
3. 매수가 발생하면 매수가+1% 금액(예: 4,000*1%=40만원)으로 바로 매도를 예약함 (매수 건당 +1% 수익 목표)
4. 매수/매도 주문은 1분에 한번 스케줄링 됨
5. 한 번 스케줄링 될 때 최대 1번의 매수 주문만 내도록 함 (혹시 모를 버그로 인한 올인 상황 방지 목적)
#

* 기본 전략의 의의
1. 현재가 대비 0.5% 하락시마다 매수하게 되므로 최대 100회 매수가 가능하게 되고 이는 최고가 대비 약 50% 하락을 견딜 수 있음
   - 실제로는 비트코인 가격 1천만원 단위로 0.5% 금액이 변하므로 50%보다 작음
   - 비트코인 가격이 낮아질수록 매도 리스트 금액 간격이 촘촘해지게 됨
   - 예) 5천만원대 -> 25만원 간격, 3천만원대 -> 15만원 간격
2. 최고가와 최고가-50% 사이에서 지속적으로 변동시 매수 건당 Unit price의 1%씩 이익이 쌓여가는 구조이며 최고가-50% 이하로 하락할 시에는 추가금 투입이 필요함
   - 비트코인은 변동성이 커서 -50% 하락이 심심치 않게 발생하므로 투자금으로 올인하지 말고 예비금을 준비하고(최소 투자금의 50% 이상 추천), 예비금은 예금 등 안전자산으로 운영 추천
   - 반등시에는 다시 예비금은 인출해서 안전자산으로 돌리고 투자금으로 운용
3. 투자 성향에 따라 전체 투자금, Unit price, Unit당 수익률을 조절 할 수 있고 이에 따라 최종 수익이 예측 가능해진다는 장점이 있음
#

* 부가 전략
1. 최고가를 돌파하며 상승하는 경우 매도할 항목이 한 개도 남아 있지 않을 상황을 대비해 최대 3개의 매도 항목을 유지할 수 있도록 현재가 근처에서 매수 진행함
#

* 최고가에 다시 도달 하지 못할 것 같은 상황에 대한 전략 (미구현)
1. 최고가에 매도 예약된 항목을 수익금의 일부를 사용해서 녹인다.
2. 투자금+예비금까지를 1:2:3으로 등분 해서 '1' 부분으로 50% 하락 커버하며 중점 투자, 추가 하락 할수록 '2' -> '3'으로 투자금을 늘리는 전략
   - 비트코인은 반등도 큰 경우가 많아 추가 하락시 이익을 극대화 할 수 있지만, 반면에 중점 투자 비중이 적어지므로 개인 성향에 따른 선택 필요
#

* 추가 투입 가능 금액 없는 상태에서 최고가-50% 이상 하락 상황에 대한 전략 (미구현)
1. 거래를 지속 발생시키는 것이 유리하므로 최고가 매도 항목을 우선 매도해서 매수 가능 금액 확보
#

* Tip
1. 거래 금액에 따른 수수료 쿠폰 구매 추천
   - 구매한 쿠폰이 60일만 유효하므로 지속적으로 평균 거래 금액 모니터링 필요
#

이상입니다.
